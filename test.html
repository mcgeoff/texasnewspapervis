<html>
  <head>
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.0/jquery.min.js"></script>
  <link href="http://code.google.com/apis/maps/documentation/javascript/examples/default.css" rel="stylesheet" type="text/css" /> 
  <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script> 
  <script type="text/javascript">
  function onClick() {
      $('#t').hide('slow', function() {
          $('#t').html(Math.random());
      });
      $('#t').show('slow');
  }

  function initialize() {
      url = '';
      var canvas = document.createElement('canvas');
      if (canvas.getContext) {
          var d = Math.floor(Math.random() * 90);
          ds = d - 5;
          canvas.width = d;
          canvas.height = d;

          var ctx = canvas.getContext('2d');
          ctx.globalAlpha = 0.5;
          ctx.fillStyle = "#ffcc55";
          ctx.arc(d/2, d/2, ds/2, 0, Math.PI * 2);
          ctx.fill();
          ctx.strokeStyle="#ff0000";
          ctx.lineWidth = 3;
          ctx.arc(d/2, d/2, ds/2, 0, Math.PI * 2);
          ctx.stroke();

          ctx.strokeStyle = '#000000';
          ctx.lineWidth = 1;
          ctx.strokeText(d, d/2 - 4, d/2 + 4);

          uri = canvas.toDataURL();
      }

      var myOptions = {
          zoom: 4,
          center: new google.maps.LatLng(-33, 151),
          mapTypeId: google.maps.MapTypeId.ROADMAP
      };
      var map = new google.maps.Map(document.getElementById("map_canvas"),
                                    myOptions);
      var image = uri;
      var myLatLng = new google.maps.LatLng(-33.890542, 151.274856);
      var beachMarker = new google.maps.Marker({
          position: myLatLng,
          map: map,
          icon: image
      });

      google.maps.event.addListener(beachMarker, 'mouseover', function() {
          $("#mousepos").html("mouseover");
      });
      google.maps.event.addListener(beachMarker, 'mouseout', function() {
          $("#mousepos").html("mouseout");
      });

      drawProgress();
  }

  var angle = 0;
  function drawProgress() {
      drawFrame();
      setInterval(drawFrame, 30);
  }

  function drawFrame() {
      var canvas = document.getElementById('progress_canvas');
      if (canvas.getContext) {
          var ctx = canvas.getContext('2d');
          ctx.strokeStyle = '#0000ff';

          ctx.clearRect(0, 0, canvas.width, canvas.height);

          var c = 100;
          var d = 50;
          var r = 8;
          var t = (Math.round(Math.random() * 100) % 12) * Math.PI / 6;

          var t = Math.PI / 24 * angle;
          angle = (angle + 1) % 48;

          ctx.beginPath();
          ctx.arc(c - d * Math.sin(t), c + d * Math.cos(t), r, 0, Math.PI * 2);
          ctx.stroke();
          ctx.beginPath();
          ctx.arc(c - d * Math.sin(t - Math.PI / 4), c + d * Math.cos(t - Math.PI / 4), 3/4*r, 0, Math.PI * 2);
          ctx.stroke();
          ctx.beginPath();
          ctx.arc(c - d * Math.sin(t - 2 * Math.PI / 5), c + d * Math.cos(t - 2 * Math.PI / 5), 2/4*r, 0, Math.PI * 2);
          ctx.stroke();
      }
  }

  </script>
  </head>

  <body onload="initialize();">
    <div id="d" onclick="onClick();">
    Where is the
    content?
    <p id='t' style='display: none'></p>
    </div>
    <div id="mousepos"></div>
    <div id="progress">
        <p id="progress_text">Text</p>
        <canvas id="progress_canvas" width="400px" height="300px">
        </canvas>
    </div>
    <div id="map_canvas"></div>
  </body>
</html>
